<UserControl x:Class="SPRNetTool.View.Widgets.BitmapViewer"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:local="clr-namespace:SPRNetTool.View.Widgets"
			 xmlns:cvt="clr-namespace:SPRNetTool.View.Utils"
			 mc:Ignorable="d"
			 d:DesignHeight="450"
			 d:DesignWidth="800"
			 x:Name="BitmapViewerContainer">

	<UserControl.Resources>
		<cvt:FormulaConverter x:Key="FormulaConverter" />
	</UserControl.Resources>
	<UserControl.Background>
		<ImageBrush Stretch="None"
					ImageSource="/SPRNetTool;component/resources/spr_viewer_background.png" />
	</UserControl.Background>
	<local:BitmapViewerInternal x:Name="BitmapViewerContainerInternal"
								DataContext="{Binding ElementName=BitmapViewerContainer, Path=ViewModel}"
								GlobalHeight="{Binding GlobalHeight}"
								GlobalWidth="{Binding GlobalWidth}"
								GlobalOffX="{Binding GlobalOffX}"
								GlobalOffY="{Binding GlobalOffY}"
								FrameHeight="{Binding FrameHeight}"
								FrameWidth="{Binding FrameWidth}"
								FrameOffX="{Binding FrameOffX}"
								FrameOffY="{Binding FrameOffY}"
								FrameSource="{Binding FrameSource}">
		<Canvas x:Name="ContainerCanvas"
				Width="{Binding ElementName=BitmapViewerContainerInternal,Path=ActualWidth}"
				ClipToBounds="True"
				Height="{Binding ElementName=BitmapViewerContainerInternal,Path=ActualHeight}">
			<Canvas ClipToBounds="True"
					Width="{Binding ElementName=BitmapViewerContainerInternal,Path=GlobalWidth}"
					Height="{Binding ElementName=BitmapViewerContainerInternal,Path=GlobalHeight}">
				<Canvas.Left>
				<MultiBinding Converter="{StaticResource FormulaConverter}"
							  ConverterParameter=" 0.5 * {0} - {1} * 0.5 + {2}">
					<Binding Path="ActualWidth"
							 ElementName="ContainerCanvas" />
					<Binding Path="GlobalWidth"
							 FallbackValue="500"
							 ElementName="BitmapViewerContainerInternal" />
					<Binding Path="GlobalOffX"
							 FallbackValue="10"
							 ElementName="BitmapViewerContainerInternal" />
				</MultiBinding>
			</Canvas.Left>

			<Canvas.Top>
				<MultiBinding Converter="{StaticResource FormulaConverter}"
							  ConverterParameter=" 0.5 * {0} - {1} * 0.5 + {2}">
					<Binding Path="ActualHeight"
							 ElementName="ContainerCanvas" />
					<Binding Path="GlobalHeight"
							 FallbackValue="200"
							 ElementName="BitmapViewerContainerInternal" />
					<Binding Path="GlobalOffY"
							 FallbackValue="10"
							 ElementName="BitmapViewerContainerInternal" />
				</MultiBinding>
			</Canvas.Top>
				<Image x:Name="SprGlobalBackgroundImage"
					   Stretch="Fill"
					   Source="../../Resources/spr_global_background.png"
					   Width="{Binding ElementName=BitmapViewerContainerInternal,Path=GlobalWidth, FallbackValue=500}"
					   Height="{Binding ElementName=BitmapViewerContainerInternal,Path=GlobalHeight, FallbackValue=200}" />
				<Image x:Name="SprFrameImage"
					   Stretch="None"
					   Source="{Binding ElementName=BitmapViewerContainerInternal, Path=FrameSource}"
					   Canvas.Left="{Binding ElementName=BitmapViewerContainerInternal, Path=FrameOffX,FallbackValue=60}"
					   Canvas.Top="{Binding ElementName=BitmapViewerContainerInternal, Path=FrameOffY,FallbackValue=60}"
					   Width="{Binding ElementName=BitmapViewerContainerInternal,Path=FrameWidth, FallbackValue=200}"
					   Height="{Binding ElementName=BitmapViewerContainerInternal,Path=FrameHeight, FallbackValue=100}" />
			</Canvas>
		</Canvas>

	</local:BitmapViewerInternal>
</UserControl>
